function rowsToObjects(e){if(!e||0===e.length)return[];const t=e[0].map(e=>String(e).trim());return e.slice(1).map(e=>{const s={};return t.forEach((t,a)=>{if(s[t]=e[a]??"",["id","price","amount","qty"].includes(t.toLowerCase())){const e=Number(s[t]);Number.isNaN(e)||""===s[t]||(s[t]=e)}}),s})}import fs from"fs/promises";import path from"path";import{fileURLToPath}from"url";import{google}from"googleapis";const __filename=fileURLToPath(import.meta.url),__dirname=path.dirname(__filename),{SHEET_ID:SHEET_ID,SHEET_RANGE:SHEET_RANGE="Sheet1!A1:Z",GOOGLE_SA_JSON_BASE64:GOOGLE_SA_JSON_BASE64,OUTPUT_PATH:OUTPUT_PATH="activities_table.json"}=process.env;let saJson;SHEET_ID&&GOOGLE_SA_JSON_BASE64||process.exit(1);try{saJson=JSON.parse(Buffer.from(GOOGLE_SA_JSON_BASE64,"base64").toString("utf8"))}catch(e){process.exit(1)}const scopes=["https://www.googleapis.com/auth/spreadsheets.readonly"],auth=new google.auth.JWT(saJson.client_email,void 0,saJson.private_key,scopes),sheets=google.sheets({version:"v4",auth:auth});(async()=>{try{await auth.authorize();const{data:e}=await sheets.spreadsheets.values.get({spreadsheetId:SHEET_ID,range:SHEET_RANGE,valueRenderOption:"UNFORMATTED_VALUE"});!e.values||e.values.length;const t=rowsToObjects(e.values||[]),s=path.join(process.cwd(),OUTPUT_PATH);await fs.mkdir(path.dirname(s),{recursive:!0}),await fs.writeFile(s,JSON.stringify(t,null,2)+"\n","utf8")}catch(e){process.exit(1)}})();