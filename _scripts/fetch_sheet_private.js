async function fetchSheet(){try{const e=(await sheets.spreadsheets.values.get({spreadsheetId:sheetId,range:sheetRange})).data.values||[];fs.writeFileSync(outputPath,JSON.stringify(e,null,2))}catch(e){process.exit(1)}}import{google}from"googleapis";import fs from"fs";const sheetId=process.env.SHEET_ID,sheetRange=process.env.SHEET_RANGE,outputPath=process.env.OUTPUT_PATH||"assets/json/table_data.json",saPath=process.env.GOOGLE_SA_JSON_PATH;let saCredentials;sheetId&&sheetRange&&saPath||process.exit(1);try{saCredentials=JSON.parse(fs.readFileSync(saPath,"utf8"))}catch(e){process.exit(1)}const auth=new google.auth.GoogleAuth({credentials:saCredentials,scopes:["https://www.googleapis.com/auth/spreadsheets.readonly"]}),sheets=google.sheets({version:"v4",auth:auth});fetchSheet();