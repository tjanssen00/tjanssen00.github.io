function rowsToObjects(e){if(!e||0===e.length)return[];const s=e[0].map(e=>String(e).trim());return e.slice(1).map(e=>{const t={};return s.forEach((s,o)=>{if(t[s]=e[o]??"",["id","price","amount","qty"].includes(s.toLowerCase())){const e=Number(t[s]);Number.isNaN(e)||""===t[s]||(t[s]=e)}}),t})}import fs from"fs/promises";import path from"path";import{fileURLToPath}from"url";import{google}from"googleapis";const __filename=fileURLToPath(import.meta.url),__dirname=path.dirname(__filename),{SHEET_ID:SHEET_ID,SHEET_RANGE:SHEET_RANGE="Sheet1!A1:Z",GOOGLE_SA_JSON_BASE64:GOOGLE_SA_JSON_BASE64,OUTPUT_PATH:OUTPUT_PATH="activities_table.json"}=process.env;SHEET_ID&&GOOGLE_SA_JSON_BASE64||process.exit(1);const saJson=JSON.parse(Buffer.from(GOOGLE_SA_JSON_BASE64,"base64").toString("utf8")),scopes=["https://www.googleapis.com/auth/spreadsheets.readonly"],auth=new google.auth.JWT(saJson.client_email,void 0,saJson.private_key,scopes),sheets=google.sheets({version:"v4",auth:auth});(async()=>{const{data:e}=await sheets.spreadsheets.values.get({spreadsheetId:SHEET_ID,range:SHEET_RANGE,valueRenderOption:"UNFORMATTED_VALUE"}),s=rowsToObjects(e.values||[]),t=path.join(process.cwd(),OUTPUT_PATH);await fs.mkdir(path.dirname(t),{recursive:!0}),await fs.writeFile(t,JSON.stringify(s,null,2)+"\n","utf8")})();